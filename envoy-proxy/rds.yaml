        
version_info: "0"
resources:
- "@type": "type.googleapis.com/envoy.config.route.v3.RouteConfiguration"
  name: local_route
  virtual_hosts:
  - name: local_service
    domains: ["*"]
    routes:
    - match: 
        prefix: "/prometheus/"
      route:
        cluster: prometheus_client
        #prefix_rewrite: "/"
        regex_rewrite: 
          pattern:
            google_re2: {}
            regex: ^/prometheus/(.*)$
          substitution: /\1
    - match: 
        prefix: "/api/v1/"
        headers: 
        - name: "X-Grpc-Web"
          exact_match: "1"
      route:
        cluster: greeter_service
        prefix_rewrite: "/"
        max_grpc_timeout: 0s
    - match: 
        prefix: "/"
      route:
        cluster: react_client
    cors:
      allow_origin_string_match:
      - prefix: "*"
      allow_methods: GET, PUT, DELETE, POST, OPTIONS
      allow_headers: keep-alive,user-agent,cache-control,content-type,content-transfer-encoding,custom-header-1,x-accept-content-transfer-encoding,x-accept-response-streaming,x-user-agent,x-grpc-web,grpc-timeout
      max_age: "1728000"
      expose_headers: custom-header-1,grpc-status,grpc-message